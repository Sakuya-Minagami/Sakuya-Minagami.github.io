---
title: 随机信号分析
---
放一点代码
# 6
```
x = unifrnd(0,1,[1,100]);
t = -2:0.1:2;
h1 = histogram(x);
xlabel('x')
title('随机变量X分布')

figure
[c,lags] = xcorr(x);
stem(lags,c)
xlabel('t')
ylabel('y')
title('x的自相关函数')

Fs=1000; %采样频率
n=0:1/Fs:1;
xn=x;
nfft=1024;
cxn=xcorr(xn,'unbiased'); %计算序列的自相关函数
CXk=fft(cxn,nfft);
Pxx=abs(CXk);
index=0:round(nfft/2-1);
k=index*Fs/nfft;
plot_Pxx=10*log10(Pxx(index+1));
figure
subplot(1,2,1);
plot(xn);
xlabel('t')
ylabel('s(t)')
title('时域信号')

subplot(1,2,2);
plot(k,plot_Pxx);
xlabel('f')
ylabel('H(f)')
title('频谱分布')
```

# 7
```
x = normrnd(2,sqrt(5),[1,100]);
t = -2:0.1:2;
h1 = histogram(x);
xlabel('x')
title('随机变量X分布')

figure
[c,lags] = xcorr(x);
stem(lags,c)
xlabel('t')
ylabel('y')
title('x的自相关函数')

Fs=1000; %采样频率
n=0:1/Fs:1;
xn=x;
nfft=1024;
cxn=xcorr(xn,'unbiased'); %计算序列的自相关函数
CXk=fft(cxn,nfft);
Pxx=abs(CXk);
index=0:round(nfft/2-1);
k=index*Fs/nfft;
plot_Pxx=10*log10(Pxx(index+1));
figure
subplot(1,2,1);
plot(xn);
xlabel('t')
ylabel('s(t)')
title('时域信号')

subplot(1,2,2);
plot(k,plot_Pxx);
xlabel('f')
ylabel('H(f)')
title('频谱分布')
```

# 8
```
Fs=1000;
n=0:1/Fs:1;
x =cos(2*pi*100*n)+cos(2*pi*200*n)+randn(size(n));
t = -2:0.1:2;
h1 = histogram(x);
xlabel('x')
title('随机变量X分布')

figure
[c,lags] = xcorr(x);
stem(lags,c)
xlabel('t')
ylabel('y')
title('x的自相关函数')

Fs=1000; %采样频率
n=0:1/Fs:1;
xn=x;
nfft=1024;
cxn=xcorr(xn,'unbiased'); %计算序列的自相关函数
CXk=fft(cxn,nfft);
Pxx=abs(CXk);
index=0:round(nfft/2-1);
k=index*Fs/nfft;
plot_Pxx=10*log10(Pxx(index+1));
figure
subplot(1,2,1);
plot(xn);
xlabel('t')
ylabel('s(t)')
title('时域信号')

subplot(1,2,2);
plot(k,plot_Pxx);
xlabel('f')
ylabel('H(f)')
title('频谱分布')
```
# 9
```
clear

N = 256;
t = 0:N-1;
m = -N:N-1;
x1n = random('norm',0,1,N,8);
% X1k = fft(x1n,2*N);
% R1x = ifft((abs(X1k).^2)/N);

A = random('unif',0,1,1,8)*2*pi;
for k =1:8
    x2n(:,k) = 2*cos(2*pi*500*t(:)/N+A(k));
    xn(:,k) = x1n(:,k)+x2n(:,k);
end
% X2k = fft(x2n,2*N);
% R2x = ifft((abs(X2k).^2)/N);
Xk = fft(xn,2*N);
Rx = ifft((abs(Xk).^2)/N);
% subplot(311);plot(m,fftshift(R1x));
% axis([-N N-1 -0.5 1.5]);
% subplot(312);plot(m,fftshift(R2x));
% axis([-N N-1 -0.5 1.5]);
subplot(211);
plot(m,fftshift(Rx));
axis([-N N-1 -0.5 1.5]);
xlabel('t')
ylabel('R')
title('x的自相关函数')

nfft=1024;
Fs = 1000;
cxn = Rx;
CXk=fft(cxn,nfft);
Pxx=abs(CXk);
index=0:round(nfft/2-1);
k=index*Fs/nfft;
plot_Pxx=Pxx(index+1);
subplot(212);
plot(k,plot_Pxx);
xlabel('f')
ylabel('H(f)')
title('频谱分布')

```
二
# 1
```
h = fir1(71,[0.25  0.55]);

[HH,WW] = freqz(h,1,512);
subplot(211);plot(WW/pi,20*log(abs(HH)));grid on;title('幅度谱');
ylabel('幅度(dB)');xlabel('f');
axis([0 1 -100 0]);
subplot(212);plot(WW/pi,unwrap(angle(HH))*180/pi);grid on;title('相位谱');
ylabel('相位(°)');xlabel('f');
```
# 2
```
N = 500;
xt = random('norm',0,1,1,N);
ht = fir1(101,[0.2,0.6]);
HW = fft(ht,2*N);

Rxx = xcorr(xt,'biased');
Sxx = abs(fft(xt,2*N).^2)/(2*N);
HW2 = abs(HW).^2;
Syy = Sxx.*HW2;
Ryy = fftshift(ifft(Syy));

w = (1:N)/N;
t = (-N:N-1)/N*(N/20000);
% subplot(411);plot(w,abs(Sxx(1:N)));title('输入信号功率谱密度');
% subplot(412);plot(w,abs(HW2(1:N)));title('系统功率传输函数');
subplot(211);plot(w,abs(Syy(1:N)));title('输出信号功率谱密度');
subplot(212);plot(t,Ryy);title('输出信号自相关函数');
```
# 3
```
N = 10000;f0 = 10000;deltf = 500;fs = 22000;M = 200;
X = Narrowbandsignal(N,f0,deltf,fs,M);
[Ac As] = Lowfsignal(X,f0,fs);
Rx = xcorr(X,'biased');
Rac = xcorr(Ac,'biased');
Ras = xcorr(As,'biased');
Racw = abs(fft(Rac));
Rasw = abs(fft(Ras));
Rxw = abs(fft(Rx));
N1 = 2*N-1;
f = fs/N1:fs/N1:fs/2;
subplot(311);
plot(f,10*log10(Rxw(1:(N1-1)/2)+eps));
subplot(312);
plot(f,10*log10(Racw(1:(N1-1)/2)+eps));
subplot(313);
plot(f,10*log10(Rasw(1:(N1-1)/2)+eps));

function X = Narrowbandsignal(N,f0,deltf,fs,M)
N1 = N-M;
xt = random('norm',0,1,[1,N1]);
f1 = f0*2/fs;
df1 = deltf/fs;
ht = fir1(M,[f1-df1 f1+df1]);

X = conv(xt,ht);
return 
end

function [Ac As] = Lowfsignal(X,f0,fs)
HX = imag(hilbert(X));
[M N] = size(X);
t = 0:1/fs:(N-1)/fs;
Ac = X.*cos(2*pi*f0*t)+HX.*sin(2*pi*f0*t);
As = HX.*cos(2*pi*f0*t)-X.*sin(2*pi*f0*t);
return 
end
```

# 4
```
clear

N = 20000;f0 = 10000;deltf = 500;fs = 22000;M = 50;

X = Narrowbandsignal(N,f0,deltf,fs,M);
X = X/sqrt(var(X));
[At Ph A2] = EnvelopPhase(X,f0,fs);
LA = 0:0.05:4.5;
subplot(311);
hist(At,LA);
LP = -pi/2:0.05:pi/2;
title('包络A(t)样本值分布直方图')
subplot(312);
hist(Ph,LP);
title('相位样本值分布直方图')
LA2 = 0:0.2:16;
subplot(313);
hist(A2,LA2);
title('包络平方值样本值分布直方图')

function X = Narrowbandsignal(N,f0,deltf,fs,M)
N1 = N-M;
xt = random('norm',0,1,[1,N1]);
f1 = f0*2/fs;
df1 = deltf/fs;
ht = fir1(M,[f1-df1 f1+df1]);

X = conv(xt,ht);
return 
end

function [At Ph A2] = EnvelopPhase(X,f0,fs)
HX = imag(hilbert(X));
[M N] = size(X);
t = 0:1/fs:(N-1)/fs;
Ac = X.*cos(2*pi*f0*t)+HX.*sin(2*pi*f0*t);
As = HX.*cos(2*pi*f0*t)-X.*sin(2*pi*f0*t);
Ph = atan(As./Ac);
A2 = Ac.*Ac+As.*As;
At = sqrt(A2);
return 
end
```
# 5
```
clear

N = 10000;f0 = 10000;deltf = 400;fs = 22000;M = 50;
a1 = 2;a2 = 4;a3 = 8;
sit1 = pi/6;sit2 = pi/4;sit3 = pi/3;
X = Narrowbandsignal(N,f0,deltf,fs,M);
X = X/sqrt(var(X));
t = 0:1/fs:((N-1)/fs);
X1 = X+a1*cos(2*pi*f0*t+sit1);
X2 = X+a2*cos(2*pi*f0*t+sit2);
X3 = X+a3*cos(2*pi*f0*t+sit3);
[At1 Ph1 A21] = EnvelopPhase(X1,f0,fs);
[At2 Ph2 A22] = EnvelopPhase(X2,f0,fs);
[At3 Ph3 A23] = EnvelopPhase(X3,f0,fs);
LA = 0:0.4:12;
GA1 = hist(At1,LA);
GA2 = hist(At2,LA);
GA3 = hist(At3,LA);
plot(LA,GA1,'--',LA,GA2,'-',LA,GA3,'-');
legend('A1(t)','A2(t)','A3(t)');
title('包络直方图')

figure;
LP = -pi/2:0.05:pi/2;
GP1 = hist((Ph1-sit1),LP);
GP2 = hist((Ph2-sit2),LP);
GP3 = hist((Ph3-sit3),LP);
plot(LP,GP1,'--',LP,GP2,'-',LP,GP3,'-');
legend('A1(t)','A2(t)','A3(t)');
title('相位直方图')

figure;
LA2 = 0:1:120;
GA21 = hist(A21,LA2);
GA22 = hist(A22,LA2);
GA23 = hist(A23,LA2);
plot(LA2,GA21,'--',LA2,GA22,'-',LA2,GA23,'-');
legend('A1(t)','A2(t)','A3(t)');
title('包络平方直方图')

function X = Narrowbandsignal(N,f0,deltf,fs,M)
N1 = N-M;
xt = random('norm',0,1,[1,N1]);
f1 = f0*2/fs;
df1 = deltf/fs;
ht = fir1(M,[f1-df1 f1+df1]);

X = conv(xt,ht);
return 
end

function [Ac As] = Lowfsignal(X,f0,fs)
HX = imag(hilbert(X));
[M N] = size(X);
t = 0:1/fs:(N-1)/fs;
Ac = X.*cos(2*pi*f0*t)+HX.*sin(2*pi*f0*t);
As = HX.*cos(2*pi*f0*t)-X.*sin(2*pi*f0*t);
return 
end

function [At Ph A2] = EnvelopPhase(X,f0,fs)
HX = imag(hilbert(X));
[M N] = size(X);
t = 0:1/fs:(N-1)/fs;
Ac = X.*cos(2*pi*f0*t)+HX.*sin(2*pi*f0*t);
As = HX.*cos(2*pi*f0*t)-X.*sin(2*pi*f0*t);
Ph = atan(As./Ac);
A2 = Ac.*Ac+As.*As;
At = sqrt(A2);
return 
end
```
