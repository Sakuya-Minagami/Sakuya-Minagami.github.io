---
title:  网易云音乐移动端
---
想一想业务需求
主体部分分为顶部栏，轮播，随机歌单，播放组件
顶部栏有左边的导航栏，我的，发现，云村，视频，
只实现我的：账号登录和信息；发现，主体页面
[接口文档](https://binaryify.github.io/NeteaseCloudMusicApi/#/)

# rem布局 （重点）
# icon引用
# 头部导航
设计思路：侧边栏，四个组件，搜索
关键：排布在同一行
```
justify-content: space-between;  
/* 均匀排列每个元素首个元素放置于起点，末尾元素放置于终点 */
justify-content: space-around;  
/* 均匀排列每个元素每个元素周围分配相同的空间 */  
```
# 组件库的引用
# 多组件封装函数
[export & import](https://www.jianshu.com/p/b69244a04f92)
# axios
[axios](http://www.axios-js.com/zh-cn/docs/)
封装axios时不知道出了什么问题，出不来数据
暂时用静态的吧。。
# 响应式，reactive
课程中用的是vue3的内容，要用vue2实现还得废点功夫。。
现在有两个方案：
1.学一遍axios，用自己的办法完成接口
2.学习vue2的封装办法，用来代替课程中vue3 的方案
行吧，给你一天时间，搞定axios

注意，现在直接写了静态的axios请求，可能有数据读晚的报错
       TypeError: Cannot read properties of undefined (reading 'nickname')

# css布局 (复习！！)
垂直居中
两侧分布
弹性布局 [display:flex](https://blog.csdn.net/weixin_42836226/article/details/102809084)

发现歌单的轮播，图片完全无法调整，不知道怎么回事

向上对齐？
单行显示，溢出文本省略

养成css写父子class的习惯，特别是工程ui多的时候！
# router-link（内容很多）
```
<router-link :to="{path:'/itemMusic',quary:{id:item.id}}">
```
传参：path和id
[四种路由传参方式](https://blog.csdn.net/qq_42696432/article/details/125400186)
# 父子通信
# 尝试修布局bug
拉动宽度，有问题的有
歌单四个选项被挤到图片右侧
播放量到处移动甚至移出图片
重新考虑如何给歌单布局
顶端没问题，fixed
# 新的布局bug
底端音乐播放器无法固定在底端，尽管代码已经设对了，不知道是哪里出现了冲突
试着取消了footMusic的高度，和footLeft的flex，出现了底端栏卡着中间线移动的情况，而且改变footRight的flex不影响，应该是left出问题了
# 音乐播放模块
audio的应用（模块）
（提问：跨域问题）
vuex的应用
## 思路
### 配置vuex
``npm install vuex --save``
在store/index.js中state管理全局变量，mutations管理全局方法，预先初始化好
### 引入
```
    import {mapState,mapMutations} from 'vuex'
    export default {
        computed: {
            ...mapState(['playList','playListIndex','isbtnShow'])
        },
        methods: {
            ...mapMutations(['updateIsbtnShow'])
        }
    }
```
需要import引入
使用变量，需要用计算属性初始化
使用方法，可直接使用
二者都需要...前缀
### 组件使用
audio组件有两个属性设置
```
<audio 
ref="audio"
:src="`https://music.163.com/song/media/outer/url?id=${playList[playListIndex].id}.mp3`">
</audio>
```
记得src带冒号动态绑定
注，因为播放功能必须有一个列表，也就有一个音乐数组，所以访问数组还需要初始化index

然后在一个播放，一个暂停按钮绑定播放audio的方法play
```
methods: {
            play: function(){
                if(this.$refs.audio.paused){
                    this.$refs.audio.play();
                    this.updateIsbtnShow(false)
                }else{
                    this.$refs.audio.pause();
                    this.updateIsbtnShow(true)
                }
            },
        }
```
#### ref的使用 组件实例方法
# 跨源问题
有很多时候，明明url没问题，但是浏览器控制台显示跨域，播放组件audio也显示无源，
有时候又可以了，状态码都是302
# 正则表达式
数据处理
# computed 的setter问题
引入的vuex中有一项被认定没有setter方法，但是却有mutation去修改
# audio 播放与进度条监听
[audio属性与事件](https://blog.csdn.net/qq_34656296/article/details/120759018)
进度条拖动问题，state与进度条value死绑，只有暂停时候能拖动
有没有办法在拖动时候阻止绑定呢？
# 搜索框常见逻辑与数据处理
# 异步请求写async await！
# url里写参数要反引号
[一点常用的语法](http://www.wjhsh.net/0627zhou-p-9953264.html)
# 关于子组件获取参数警告
[vue更新推荐方案](https://cloud.tencent.com/developer/article/2023612?from=15425)
找到的解决办法：在父组件传参时，使用``v-if="playlist.creator``
在会出现undefined的上一级判断是否存在
# 布局问题解决了？
在静态文件中设置``<meta maximum-scale=1.0,user-scalable=0>``
之前失效的布局有效了，说明是移动端出的问题，在pc布局应该没问题
## 顺便排查了页面滚动问题，可以直接禁止
``<div @touchmove.prevent></div>``
页面可以上下滑动滚动，不能移动页面
但是拉动边框之后又失效了
## 右侧空白
原来``overflow:hidden``就好了
# 关于audio currenttime问题
[大概是服务器的问题](https://segmentfault.com/q/1010000002908474)

